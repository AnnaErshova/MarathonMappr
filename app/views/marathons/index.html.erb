<p id="notice"><%= notice %></p>

<h1>Race List:</h1>



<!-- scripts for google maps -->
<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript">
</script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'>
</script>

<!-- gmaps rendering -->
<div style='width: 800px;'>
    <div id="map" style='width: 800px; height: 400px;'>
    </div>
</div>

<!-- code from http://apneadiving.github.io/ -->
<script type"text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    });
</script>


<%= search_form_for @q do |f| %>
  <fieldset>
    <legend>Marathon</legend>
    <ul>
        <!-- checks if race name matches a query -->
        <%= f.label :name_cont %>
        <%= f.text_field :name_cont%>
        <!-- checks if location matches a query -->
        <%= f.label :city_and_or_country_cont %>
        <%= f.text_field :city_or_country_cont %>
    </ul>
  </fieldset>

  <%= f.submit %>
<% end %>


<table>
  <thead>
    <h3>Use Column Headers to Filter Race Results:</h3>
    <tr>
      <th><%= sort_link(@q, :event_date, "Date", default_order: :asc) %></th>
      <th><%= sort_link(@q, :name, [:name, 'event_date_asc'],'Name') %></th>
      <th><%= sort_link(@q, :city, [:city, 'event_date_asc'], 'City') %></th>
      <th><%= sort_link(@q, :country, [:country, 'event_date_asc'], 'Country') %></th>
      <th>Type</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @marathons.each do |marathon| %>
      <tr>
        <td><%= marathon.event_date %></td>
        <td><%= marathon.name %></td>
        <td><%= marathon.city %></td>
        <td><%= marathon.country %></td>
        <td><%= marathon.kind %></td>

        <td><%= link_to 'Show', marathon %></td>
        <td><%= link_to 'Edit', edit_marathon_path(marathon) %></td>
        <td><%= link_to 'Destroy', marathon, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Marathon', new_marathon_path %>



